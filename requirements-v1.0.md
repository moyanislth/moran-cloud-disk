# 墨染云盘项目需求文档 (v1.0 - 第一版需求设计)

**文档版本**：v1.0  
**发布日期**：2025-11-08  
**作者**：Grok  
**状态**：批准用于编码设计  
**概述**：本文档基于用户反馈，从简定义自用网盘项目的 MVP。聚焦核心功能，技术栈固定为 Spring Boot + React。后续迭代基于反馈。

------

## 1. 项目概述

- **项目名称**：墨染云盘。
- **项目目标**：开发一个简单、可靠的自用文件存储和管理系统，支持个人文件上传/下载/浏览，实现随时随地访问。非商业用途，仅限单用户（您自己）。
- **范围**：从零开发，使用 Java (Spring Boot) 后端 + React 前端。部署到个人PC，支持本地存储起步。
- **优先级**：MVP 聚焦核心文件操作，后续迭代扩展。
- **假设**：单用户、无多设备同步需求。总存储限由 yml 配置（默认 10GB，可调）。
- **UI 风格**：扁平风格，提供简洁、现代的视觉体验。

------

## 2. 用户角色与场景

- 用户角色 

  - **文件所有者**（管理员）：完整访问权限（上传/下载/管理）。
  - **访客**：仅查看文件列表（无详情/下载/修改）。

- 典型使用场景

  - 管理员登录后浏览文件列表、上传/下载/管理。
  - 访客无登录查看文件列表（仅文件名/文件夹）。
  - 拖拽上传新文件（仅管理员）。
  - 点击下载或预览文件（仅管理员）。
  - 删除/重命名文件（仅管理员）。

- **登录方式**：用户名/密码 + QQ 登录（OAuth2）。默认管理员账号/密码：admin/admin。支持“记住我”选项（Cookie 持久化 7 天）。

------

## 3. 功能需求

采用用户故事格式，从简列出 MVP 核心。每个故事包括：**作为...我希望...以便...**。

### 3.1 认证与访问控制

- US-001

  ：作为文件所有者，我希望通过用户名/密码或 QQ 登录访问系统，以便保护文件隐私。

  - 细节：使用 JWT Token 保持会话。密码哈希存储（BCrypt）。QQ 登录集成 OAuth2。

- US-002

  ：作为访客，我希望无登录查看文件列表（仅文件名/文件夹），但无法下载/预览/修改，以便简单浏览。

  - 细节：访客模式默认无 Token，权限检查拦截敏感操作。

- US-003

  ：作为用户，我希望“记住我”选项保持登录状态，以便便捷访问。

  - 细节：选中时用安全 Cookie 存储 Token（过期 7 天）。

### 3.2 文件管理

- US-004

  ：作为文件所有者，我希望上传文件（支持拖拽、多选）到根目录或子文件夹，以便存储新内容。

  - 细节：支持常见格式（PDF、图片、视频等），最大单文件 500MB。进度条显示。仅管理员权限。

- US-005

  ：作为用户，我希望浏览文件列表（按名称/日期排序），以便查看和管理。

  - 细节：表格视图，显示名称、大小、修改时间。分页（每页 50 项）。支持文件夹嵌套 + 面包屑导航（e.g., 首页 > Documents > Work）。

- US-006

  ：作为文件所有者，我希望下载文件或预览（图片/文本直接显示），以便访问内容。

  - 细节：下载用流式响应；预览仅限浏览器支持格式。仅管理员权限。

- US-007

  ：作为文件所有者，我希望删除或重命名文件，以便维护存储。

  - 细节：删除前确认弹窗；重命名实时更新。仅管理员权限。

- US-008

  ：作为用户，我希望创建/进入文件夹，以便组织文件。

  - 细节：支持多级嵌套，DB 存目录树（递归查询）。

### 3.3 存储与配额

- US-009

  ：作为文件所有者，我希望系统限制总存储空间（yml 配置），以便避免磁盘溢出。

  - 细节：上传前检查剩余空间，超限提示。存储位置：本地磁盘，路径由 yml 指定（e.g., /data/uploads）。无需备份。

------

## 4. 非功能需求

- **性能**：响应时间 < 2s（上传除外）。支持 1 用户并发。
- **安全**：HTTPS 强制；文件路径用 UUID 隐藏；输入验证防注入。QQ 登录用官方 SDK（免费）。
- **可用性**：响应式 UI（Mobile First，确保小屏布局舒适，如触屏拖拽）；扁平风格，一致性强。国际化：仅中文。
- **错误处理**：清晰、友好、帮助恢复（e.g., “上传失败：磁盘满。请清理空间或联系支持” + 具体按钮如“重试”）。
- **可维护性**：模块化代码；日志记录错误。
- **部署**：Docker 一键部署到 Ubuntu VPS；域名访问（e.g., yourdrive.com）。预算 0，完全免费（开源工具 + 免费 VPS 试用如 Oracle Always Free）。

------

## 5. 技术约束与假设

- **技术栈**：后端 - Spring Boot 3.x + JPA + MySQL；前端 - React 18 + Axios + 现代组件库（MUI 或 Chakra UI，提供美观一致性）。
- **集成**：QQ OAuth2（免费 SDK）；无其他外部服务（除 HTTPS 证书，Let's Encrypt 免费）。
- **测试**：无需测试覆盖（聚焦 MVP 快速实现）。
- **免费原则**：所有工具/服务开源/免费（e.g., MySQL Community、Docker、Nginx）。

------

## 6. 风险与依赖

- **风险**：大文件上传中断（缓解：分片上传，后期迭代）。服务器磁盘满（监控脚本，免费工具如 df 命令）。
- **依赖**：Java 17、Node 18；MySQL 8.x；VPS 环境（Ubuntu）。QQ App ID（免费申请）。
- **预算/时间线**：0 元，完全免费。MVP 时间线：2 周（优先实现核心）。

------

## 7. 附录：迭代路线图

- **Phase 1 (MVP)**：核心功能上线（认证、文件 CRUD、文件夹、访客模式、配额）。
- **Phase 2**：优化（分片上传、性能调优）。
- **Phase 3**：扩展（版本历史、加密）。
- **优先级**：先实现 MVP，其余迭代基于反馈。

------

**变更历史**：

- v1.0：初始发布，基于用户反馈整合所有需求。